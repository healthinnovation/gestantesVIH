dataprep<-function(data){
  data %>% 
    select(CASEID,
      year,V012,
      V190,
      V150,
      V025,
      V103,
      V136,
      V131,
      V024,
      V155,
      V001,
      V005,
      V022,
      HV115,
      S108N,
      SREGION,
      S621,
      S704N,
      S802,
      S815AA,
      S815AB,
      S815AC,
      S815AD,
      S815AE,
      S815AX,
      S815AZ,
      S816AA,
      S816AB,
      S816AC,
      S816AD,
      S816AE,
      S816AF,
      S816AG,
      S816AH,
      S816AI,
      S816AJ,
      S816AK,
      S816AL,
      S816AW,
      S816AZ,
      S413,
      S411G,
      S411H,
      M2A,
      M2B,
      M2C,
      M2D,
      M2E,
      M2F,
      M2G,
      M2H,
      M2I,
      M2J,
      M2K,
      M2L,
      M2M,
      M2N,
      M10,
      M13,
      M14,
      M57E,
      M57F,
      M57G,
      M57H,
      M57I,
      M57J,
      M57K,
      M57L,
      M57M,
      M57N,
      M57O,
      M57P,
      M57Q,
      M57R,
      M57S,
      M57T,
      M57U,
      M57V,
      M57X,
      D118Y,
      V763A,
      V763B,
      V763C,
      V774A,
      V774B,
      V774C,
      V201,
      V208,
      V211,
      SH11A,
      SH11B,
      SH11C,
      SH11D,
      SH11E,
      SH11Y,
      SH11Z,
      HC1,
    ) %>% 
    
    mutate(
      V005 = V005/1000000,
      S411H = as.factor(ifelse(S411H == 1,"Si","No")),
      
      S411G = as.factor(ifelse(S411G == 1,"Si","No")),
      
      SREGION = as.factor(SREGION),
      
      EDAD_MADRE = ifelse(V012<25,"15-24a",
                          ifelse(V012>=25&V012<30,"25-30a",
                                 ifelse(V012>=30&V012<35,"30-35a",
                                        ifelse(V012>=35,"35 a mas",NA)))),
      
      INDICERIQUEZA = factor(V190, levels = c(1:5), labels = c("1ro","2do","3ro","4to","5to")),
      
      TIPORESIDENCIA = ifelse(V025==1,"URBANO","RURAL"),
      
      MIEMBROS_HOGAR = ifelse(V136<5,"1-4",
                          ifelse(V136>=5&V136<7,"5-6",
                              ifelse(V012>=7,"7 a mas",NA))),
  
      ETNICIDAD = factor(V131, levels = c(1:12), labels = c("quechua","aimara","ashaninka","awajun",
                                                              "shipibo","shawi","matsigenka","achuar",
                                                              "Otro","castellano","portugues","Otro extranjero")),
      ETNIA_MADRE = ifelse(V131==10,"castellano",
                           ifelse(V131==1, "quechua",
                                  ifelse(V131==2, "aimara",
                                         ifelse(V131>=3&V131<=9, "amazonÃ­a",
                                                ifelse(V131>=11,"extranjero",NA))))),
      ESTADO_CIVIL = ifelse(HV115==0,"soltero", 
                            ifelse(HV115>=1&HV115<=2,"casado/conviviente", 
                                   ifelse(HV115>=3,"viuda/divorc/separ",NA))),
      
      DEPARTAMEN = factor(V024, levels = c(1:25), labels = c("AMAZONAS","ANCASH","APURIMAC","AREQUIPA","AYACUCHO",
                                                             "CAJAMARCA","CALLAO","CUSCO","HUANCAVELICA","HUANUCO",
                                                             "ICA","JUNIN","LA LIBERTAD","LAMBAYEQUE","LIMA",
                                                             "LORETO","MADRE DE DIOS","MOQUEGUA","PASCO","PIURA",
                                                             "PUNO","SAN MARTIN","TACNA","TUMBES","UCAYALI")),
      
      
      EDU_MADRE = as.factor(factor(S108N, levels = c(0,1,2,3), labels = c("sin educ","primaria","secundaria","superior"))),
      
      REGIONNATURAL = factor(SREGION, levels = c(1,2,3,4), labels = c("limaMetro","Costa","Sierra","Selva")),
      EDAD_HIJOS = ifelse(HC1<=12, "menor igual a 12 meses", "mayor de 12 meses")
      
      RELACIONJEFE = ifelse(V150==1,"Jefe", 
                            ifelse(V150==2, "Esposa", 
                                   ifelse(V150==3, "Hijo/a", 
                                          ifelse(V150>=4, "Otro", NA)))),
      
    )
}
